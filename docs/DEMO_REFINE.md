1. Before you start, please follow the instructions to prepare the dataset as described [here](https://github.com/Nicholasli1995/SNVC/blob/master/docs/DATASET.md). 

2. Download the model checkpoint and coarse proposals [here](https://drive.google.com/file/d/18fL0DAuq7L4Xe-k-gytYIo-nRQEXSjKI/view?usp=share_link). The files in the zipped file have the following structure. ${V-A} denotes the unzipped file directory.

   ```
   ${V-A}
   ├── epoch_80.tar (The model checkpoint)
   ├── save_config.py (The experiment configuration file)
   ├── IDA-3D (predictions generated by IDA-3D)
      ├── xxxxxx.txt (IDA-3D predictions for image xxxxxx)
   ├── RTS-3D (predictions generated by RTS-3D)
      ├── xxxxxx.txt (RTS-3D predictions for image xxxxxx)      
   ```
   
3. Change directory to tools and run

```bash
 python inference_agnostic.py --loadmodel ${V-A}/epoch_80.tar --pred_dir ${V-A}/IDA-3D --devices "0" --debug
```

This command loads a IDA-3D prediction, refines its pose and visualize the process. You should be able to see figures like below:

