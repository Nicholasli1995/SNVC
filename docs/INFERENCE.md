## Preparation
Before you start, please follow the instructions to prepare the dataset as described [here](https://github.com/Nicholasli1995/SNVC/blob/master/docs/DATASET.md). 

## Model-agnostic inference
If you have done this step in the refinement demo, skip this step.
 
Download the model checkpoint and coarse proposals [here](https://drive.google.com/file/d/18fL0DAuq7L4Xe-k-gytYIo-nRQEXSjKI/view?usp=share_link). The files in the zipped file have the following structure. ${V-A} denotes the unzipped file directory.

   ```
   ${V-A}
   ├── epoch_80.tar (The model checkpoint)
   ├── save_config.py (The experiment configuration file)
   ├── IDA-3D (predictions generated by IDA-3D)
      ├── xxxxxx.txt (IDA-3D predictions for image xxxxxx)
   ├── RTS-3D (predictions generated by RTS-3D)
      ├── xxxxxx.txt (RTS-3D predictions for image xxxxxx)      
   ```
   
Change directory to SNVC_DIR/tools and run

```bash
 python inference_agnostic.py --loadmodel ${V-A}/epoch_80.tar --output_dir OUTPUT_DIR --pred_dir ${V-A}/IDA-3D --btest BATCH_SIZE
```
Here OUTPUT_DIR is the directory storing output files and BATCH_SIZE denotes the batch size. If you have a GPU with 12GB memory, you can use BATCH_SIZE <= 10.

This command loads IDA-3D predictions, refines the 3D object predictions corresponding to Table 3 in the paper. You can also use the provided RTS-3D predictions.

If you want to visualize the predictions, set --debug.

To obtain quantitative evaluations, change directory to SNVC_DIR/tools/kitti-eval and run
```bash
 ./evaluate_object_3d_offline GT_DIR OUTPUT_DIR/all_parts
```
Here GT_DIR is the path to ground truth kitti labels.

## Model-specific inference
Updating
